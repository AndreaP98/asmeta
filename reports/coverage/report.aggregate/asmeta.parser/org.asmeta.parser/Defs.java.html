<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="it"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>Defs.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">report.aggregate</a> &gt; <a href="../index.html" class="el_bundle">asmeta.parser</a> &gt; <a href="index.source.html" class="el_package">org.asmeta.parser</a> &gt; <span class="el_source">Defs.java</span></div><h1>Defs.java</h1><pre class="source lang-java linenums">package org.asmeta.parser;


import java.util.Collection;
import java.util.Iterator;
import java.util.List;

import asmeta.definitions.ControlledFunction;
import asmeta.definitions.DerivedFunction;
import asmeta.definitions.DynamicFunction;
import asmeta.definitions.Function;
import asmeta.definitions.MonitoredFunction;
import asmeta.definitions.OutFunction;
import asmeta.definitions.RuleDeclaration;
import asmeta.definitions.SharedFunction;
import asmeta.definitions.StaticFunction;
import asmeta.definitions.domains.AbstractTd;
import asmeta.definitions.domains.BagDomain;
import asmeta.definitions.domains.BooleanDomain;
import asmeta.definitions.domains.ConcreteDomain;
import asmeta.definitions.domains.Domain;
import asmeta.definitions.domains.EnumTd;
import asmeta.definitions.domains.MapDomain;
import asmeta.definitions.domains.PowersetDomain;
import asmeta.definitions.domains.ProductDomain;
import asmeta.definitions.domains.RuleDomain;
import asmeta.definitions.domains.SequenceDomain;
import asmeta.definitions.domains.StringDomain;
import asmeta.definitions.domains.StructuredTd;
import asmeta.structure.Asm;
import asmeta.structure.Signature;
import asmeta.transitionrules.basictransitionrules.BlockRule;
import asmeta.transitionrules.basictransitionrules.MacroCallRule;
import asmeta.transitionrules.basictransitionrules.Rule;
import asmeta.transitionrules.turbotransitionrules.SeqRule;

/**
 * added 7 Jan 2008 by acarioni
 * 
 * A collection of methods to compare declarations, classify functions,... 
 *
 */
<span class="nc" id="L43">public class Defs {</span>
	
	/**
	 * Compares two domain declarations.
	 * 
	 * @param d1 a domain
	 * @param d2 another domain
	 * @return true if the declarations are equal, false otherwise
	 */
	public static boolean equals(Domain d1, Domain d2) {
<span class="fc bfc" id="L53" title="All 2 branches covered.">		if (!(d1 instanceof StructuredTd)) {</span>
<span class="pc bpc" id="L54" title="1 of 2 branches missed.">			if (d2 instanceof StructuredTd) {</span>
<span class="nc" id="L55">				return false;</span>
			}
			// non-structured domains
<span class="fc" id="L58">			String name1 = d1.getName();</span>
<span class="fc" id="L59">			String name2 = d2.getName();</span>
<span class="fc" id="L60">			String moduleName1 = getAsmName(d1);</span>
<span class="fc" id="L61">			String moduleName2 = getAsmName(d2);</span>
<span class="pc bpc" id="L62" title="2 of 4 branches missed.">			return name1.equals(name2) &amp;&amp; moduleName1.equals(moduleName2);</span>
			// structured domains
<span class="pc bpc" id="L64" title="1 of 2 branches missed.">		} else if (d1 instanceof ProductDomain) {</span>
<span class="nc bnc" id="L65" title="All 2 branches missed.">			if (!(d2 instanceof ProductDomain)) {</span>
<span class="nc" id="L66">				return false;</span>
			}
<span class="nc" id="L68">			List&lt;?&gt; lst1 = ((ProductDomain) d1).getDomains();</span>
<span class="nc" id="L69">			List&lt;?&gt; lst2 = ((ProductDomain) d2).getDomains();</span>
<span class="nc bnc" id="L70" title="All 2 branches missed.">			if (lst1.size() != lst2.size()) {</span>
<span class="nc" id="L71">				return false;</span>
			}
<span class="nc" id="L73">			Iterator&lt;?&gt; i1 = lst1.iterator();</span>
<span class="nc" id="L74">			Iterator&lt;?&gt; i2 = lst2.iterator();</span>
<span class="nc bnc" id="L75" title="All 2 branches missed.">			while (i1.hasNext()) {</span>
<span class="nc" id="L76">				Domain dd1 = (Domain) i1.next();</span>
<span class="nc" id="L77">				Domain dd2 = (Domain) i2.next();</span>
<span class="nc bnc" id="L78" title="All 2 branches missed.">				if (!equals(dd1, dd2)) {</span>
<span class="nc" id="L79">					return false;</span>
				}
<span class="nc" id="L81">			}</span>
<span class="nc" id="L82">			return true;</span>
<span class="pc bpc" id="L83" title="1 of 2 branches missed.">		} else if (d1 instanceof PowersetDomain) {</span>
<span class="nc bnc" id="L84" title="All 2 branches missed.">			if (!(d2 instanceof PowersetDomain)) {</span>
<span class="nc" id="L85">				return false;</span>
			}
<span class="nc" id="L87">			Domain dd1 = ((PowersetDomain) d1).getBaseDomain();</span>
<span class="nc" id="L88">			Domain dd2 = ((PowersetDomain) d2).getBaseDomain();</span>
<span class="nc" id="L89">			return equals(dd1, dd2);</span>
<span class="pc bpc" id="L90" title="1 of 2 branches missed.">		} else if (d1 instanceof SequenceDomain) {</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">			if (!(d2 instanceof SequenceDomain)) {</span>
<span class="nc" id="L92">				return false;</span>
			}
<span class="nc" id="L94">			Domain dd1 = ((SequenceDomain) d1).getDomain();</span>
<span class="nc" id="L95">			Domain dd2 = ((SequenceDomain) d2).getDomain();</span>
<span class="nc" id="L96">			return equals(dd1, dd2);</span>
<span class="pc bpc" id="L97" title="1 of 2 branches missed.">		} else if (d1 instanceof RuleDomain) {</span>
<span class="pc bpc" id="L98" title="1 of 2 branches missed.">			if (!(d2 instanceof RuleDomain)) {</span>
<span class="nc" id="L99">				return false;</span>
			}
<span class="fc" id="L101">			List&lt;?&gt; lst1 = ((RuleDomain) d1).getDomains();</span>
<span class="fc" id="L102">			List&lt;?&gt; lst2 = ((RuleDomain) d2).getDomains();</span>
<span class="pc bpc" id="L103" title="1 of 2 branches missed.">			if (lst1.size() != lst2.size()) {</span>
<span class="nc" id="L104">				return false;</span>
			}
<span class="fc" id="L106">			Iterator&lt;?&gt; i1 = lst1.iterator();</span>
<span class="fc" id="L107">			Iterator&lt;?&gt; i2 = lst2.iterator();</span>
<span class="fc bfc" id="L108" title="All 2 branches covered.">			while (i1.hasNext()) {</span>
<span class="fc" id="L109">				Domain dd1 = (Domain) i1.next();</span>
<span class="fc" id="L110">				Domain dd2 = (Domain) i2.next();</span>
<span class="pc bpc" id="L111" title="1 of 2 branches missed.">				if (!equals(dd1, dd2)) {</span>
<span class="nc" id="L112">					return false;</span>
				}
<span class="fc" id="L114">			}</span>
<span class="fc" id="L115">			return true;			</span>
<span class="nc bnc" id="L116" title="All 2 branches missed.">		} else if (d1 instanceof BagDomain) {</span>
<span class="nc bnc" id="L117" title="All 2 branches missed.">			if (!(d2 instanceof BagDomain)) {</span>
<span class="nc" id="L118">				return false;</span>
			}
<span class="nc" id="L120">			Domain dd1 = ((BagDomain) d1).getDomain();</span>
<span class="nc" id="L121">			Domain dd2 = ((BagDomain) d2).getDomain();</span>
<span class="nc" id="L122">			return equals(dd1, dd2);</span>
<span class="nc bnc" id="L123" title="All 2 branches missed.">		} else if (d1 instanceof MapDomain) {</span>
<span class="nc bnc" id="L124" title="All 2 branches missed.">			if (!(d2 instanceof MapDomain)) {</span>
<span class="nc" id="L125">				return false;</span>
			}
<span class="nc" id="L127">			Domain sd1 = ((MapDomain) d1).getSourceDomain();</span>
<span class="nc" id="L128">			Domain sd2 = ((MapDomain) d2).getSourceDomain();</span>
<span class="nc" id="L129">			Domain td1 = ((MapDomain) d1).getTargetDomain();</span>
<span class="nc" id="L130">			Domain td2 = ((MapDomain) d2).getTargetDomain();</span>
<span class="nc bnc" id="L131" title="All 4 branches missed.">			return equals(sd1, sd2) &amp;&amp; equals(td1, td2);</span>
		}
<span class="nc" id="L133">		throw new RuntimeException(&quot;Unable to compare domains: &quot; </span>
<span class="nc" id="L134">				+ d1.getName() + &quot;, &quot; + d2.getName());</span>
	}
		
	/**
	 * Checks if a domain is a subset of another domain.&lt;br&gt;&lt;br&gt;
	 * Example:&lt;br&gt;
	 * domain A&lt;br&gt;
	 * domain B subsetof A&lt;br&gt;
	 * domain C subsetof B&lt;br&gt;&lt;br&gt;
	 * Transitively, C is a subset of A.
	 * 
	 * @param dom1 a domain
	 * @param dom2 another domain
	 * @return true if dom1 is a subset of dom2, false otherwise
	 */
	public static boolean isSubsetOf(Domain dom1, Domain dom2) {
//		for (;;) {
//			if (Defs.equals(dom1, dom2)) {
//				// FIXME I assume that dom1 and dom2 have the same type domain
//				return true;
//			}			
//			if (dom1 instanceof ConcreteDomain) {
//				// climb the hierarchy
//				ConcreteDomain cdom = (ConcreteDomain) dom1;
//				dom1 = cdom.getTypeDomain();
//				continue;
//			}
//			// dom1 has not super set
//			return false;
//		}
<span class="nc bnc" id="L164" title="All 2 branches missed.">		return subsetOfMetric(dom1, dom2) &gt;= 0;</span>
	}

	/**
	 * Checks if a domain is a subset of another domain.&lt;br&gt;&lt;br&gt;
	 * Example:&lt;br&gt;
	 * domain A&lt;br&gt;
	 * domain B subsetof A&lt;br&gt;
	 * domain C subsetof B&lt;br&gt;&lt;br&gt;
	 * Transitively, C is a subset of A.
	 * 
	 * @param dom1 a domain
	 * @param dom2 another domain
	 * @return true if dom1 is a subset of dom2, -1 otherwise
	 */
	public static int subsetOfMetric(Domain dom1, Domain dom2) {
<span class="nc" id="L180">		for (int i = 0;; i++) {</span>
<span class="nc bnc" id="L181" title="All 2 branches missed.">			if (Defs.equals(dom1, dom2)) {</span>
				// FIXME I assume that dom1 and dom2 have the same type domain
<span class="nc" id="L183">				return i;</span>
			}			
<span class="nc bnc" id="L185" title="All 2 branches missed.">			if (dom1 instanceof ConcreteDomain) {</span>
				// climb the hierarchy
<span class="nc" id="L187">				ConcreteDomain cdom = (ConcreteDomain) dom1;</span>
<span class="nc" id="L188">				dom1 = cdom.getTypeDomain();</span>
<span class="nc" id="L189">				continue;</span>
			}
			// dom1 has not super set
<span class="nc" id="L192">			return -1;</span>
		}
	}
	

	/**
	 * Compares two function  declarations.
	 * 
	 * @param f1 a function
	 * @param f2 another function
	 * @return true if the declarations are equal, false otherwise
	 */
	public static boolean equals(Function f1, Function f2) {
<span class="fc" id="L205">		String name1 = f1.getName();</span>
<span class="fc" id="L206">		String name2 = f2.getName();</span>
<span class="fc" id="L207">		String moduleName1 = getAsmName(f1);</span>
<span class="fc" id="L208">		String moduleName2 = getAsmName(f2);</span>
<span class="fc bfc" id="L209" title="All 2 branches covered.">		if (name1.equals(name2) </span>
<span class="pc bpc" id="L210" title="1 of 2 branches missed.">			&amp;&amp; f1.getArity() == f2.getArity() </span>
<span class="pc bpc" id="L211" title="1 of 2 branches missed.">			&amp;&amp; moduleName1.equals(moduleName2)) {</span>
			// check parameter types
<span class="fc" id="L213">			Domain d1 = f1.getDomain();</span>
<span class="fc" id="L214">			Domain d2 = f2.getDomain();</span>
<span class="fc" id="L215">			Domain cd1 = f1.getCodomain();</span>
<span class="fc" id="L216">			Domain cd2 = f2.getCodomain();</span>
			// 0-arity functions have a null domain
<span class="pc bpc" id="L218" title="1 of 4 branches missed.">			if (d1 == null || d2 == null) {</span>
<span class="pc bpc" id="L219" title="3 of 6 branches missed.">				return d1 == null &amp;&amp; d2 == null &amp;&amp; equals(cd1, cd2);</span>
			}
<span class="pc bpc" id="L221" title="2 of 4 branches missed.">			return equals(d1, d2) &amp;&amp; equals(cd1, cd2);</span>
		}
<span class="fc" id="L223">		return false;</span>
	}
	
	/**
	 * Returns the model of the given domain.
	 * 
	 * @param d a domain
	 * @return the model, null if the domain is built-in
	 */
	public static Asm getAsm(Domain d) {
<span class="fc" id="L233">		Signature sig = d.getSignature();</span>
<span class="fc bfc" id="L234" title="All 2 branches covered.">		if (sig == null) return null;</span>
<span class="fc" id="L235">		Asm asm = sig.getHeaderSection().getAsm();</span>
<span class="fc" id="L236">		return asm;</span>
	}
	
	/**
	 * Returns the module name of a domain.
	 * 
	 * @param d a domain
	 * @return the module name, &quot;&quot; if the domain is built-in
	 */
	public static String getAsmName(Domain d) {
<span class="fc" id="L246">		Asm asm = getAsm(d);</span>
<span class="fc bfc" id="L247" title="All 2 branches covered.">		if (asm == null) return &quot;&quot;;</span>
<span class="fc" id="L248">		return asm.getName();</span>
	}

	/**
	 * Returns the module of a function.
	 * 
	 * @param f a function
	 * @return the module
	 */
	public static Asm getAsm(Function f) {
<span class="fc" id="L258">		Signature sig = f.getSignature();</span>
<span class="pc bpc" id="L259" title="1 of 2 branches missed.">		if (sig!=null)</span>
<span class="fc" id="L260">		  return sig.getHeaderSection().getAsm();</span>
<span class="nc" id="L261">		else return null;</span>
	}

	/**
	 * Returns the module name of a function.
	 * 
	 * @param f a function
	 * @return the module name
	 */
	public static String getAsmName(Function f) {
<span class="fc" id="L271">		Asm asm = getAsm(f);</span>
<span class="fc" id="L272">		return asm.getName();</span>
	}

	/**
	 * Returns the module of a rule.
	 * 
	 * @param rd a rule
	 * @return the module
	 */
	public static Asm getAsm(RuleDeclaration rd) {
<span class="fc" id="L282">		Asm asm = rd.getAsmBody().getAsm();</span>
<span class="fc" id="L283">		return asm;</span>
	}

	/**
	 * Returns the module name of a RuleDeclaration.
	 * 
	 * @param f a function
	 * @return the module name
	 */
	public static String getAsmName(RuleDeclaration rd) {		
<span class="nc" id="L293">		Asm asm = getAsm(rd);</span>
<span class="nc" id="L294">		return asm.getName();</span>
	}

    /**
     * A function is static if and only if it is a &lt;i&gt;StaticFunction&lt;/i&gt;.
     * 
     * @param func a function
     * @return True if it is static
     */
    public static boolean isStatic(Function func) {
<span class="fc" id="L304">    	return func instanceof StaticFunction;</span>
    }
    
    /**
     * A function is dynamic if and only if it is a &lt;i&gt;DynamicFunction&lt;/i&gt;.
     * 
     * @param func a function
     * @return True if it is dynamic
     */
    public static boolean isDynamic(Function func) {
<span class="nc" id="L314">    	return func instanceof DynamicFunction;</span>
    }

    /**
     * A function is controlled if and only if it is a &lt;i&gt;ControlledFunction&lt;/i&gt;.
     * 
     * @param func a function
     * @return True if it is controlled
     */
    public static boolean isControlled(Function func) {
<span class="fc" id="L324">    	return func instanceof ControlledFunction;</span>
    }

    /**
     * A function is controlled if and only if it is a &lt;i&gt;MonitoredFunction&lt;/i&gt;.
     * 
     * @param func a function
     * @return True if it is monitored
     */
    public static boolean isMonitored(Function func) {
<span class="fc" id="L334">    	return func instanceof MonitoredFunction;</span>
    }
    
    /**
     * A function is derived if and only if it is a &lt;i&gt;DerivedFunction&lt;/i&gt;.
     * 
     * @param func a function
     * @return True if it is derived
     */
    public static boolean isDerived(Function func) {
<span class="fc" id="L344">    	return func instanceof DerivedFunction;</span>
    }
    
    /**
     * A function is out if and only if it is a &lt;i&gt;OutFunction&lt;/i&gt;.
     * 
     * @param func a function
     * @return True if it is out
     */
    public static boolean isOut(Function func) {
<span class="fc" id="L354">    	return func instanceof OutFunction;</span>
    }

    /**
     * A function is shared if and only if it is a &lt;i&gt;SharedFunction&lt;/i&gt;.
     * 
     * @param func a function
     * @return True if it is shared
     */
    public static boolean isShared(Function func) {
<span class="fc" id="L364">    	return func instanceof SharedFunction;</span>
    }

    /**
     * A function is constant if and only if it is static and has arity 0.
     * 
     * @param func a function
     * @return True if it is constant
     */
    public static boolean isConst(Function func) {
<span class="fc" id="L374">    	return</span>
<span class="fc bfc" id="L375" title="All 2 branches covered.">    		isStatic(func) &amp;&amp;</span>
<span class="fc bfc" id="L376" title="All 2 branches covered.">    		func.getDomain() == null; </span>
    }

    /**
     * A function is an abstract constant if and only if it is constant and 
     * the codomain is abstract or an abstract subdomain.
     * 
     * @param func a function
     * @return True if it is an abstract constant
     */
    public static boolean isAbstractConst(Function func) {
<span class="fc" id="L387">    	return</span>
<span class="fc bfc" id="L388" title="All 2 branches covered.">    		isConst(func) &amp;&amp;</span>
<span class="fc bfc" id="L389" title="All 2 branches covered.">    		(func.getCodomain() instanceof AbstractTd ||</span>
<span class="fc bfc" id="L390" title="All 2 branches covered.">   			(func.getCodomain() instanceof ConcreteDomain &amp;&amp;</span>
<span class="fc bfc" id="L391" title="All 2 branches covered.">			((ConcreteDomain) func.getCodomain()).getTypeDomain() instanceof AbstractTd));</span>
    }

    /**
     * A function is an agent constant if and only if it is constant and 
     * the codomain is &lt;i&gt;Agent&lt;/i&gt; or an &lt;i&gt;Agent&lt;/i&gt; subdomain.
     * 
     * @param func a function
     * @return True if it is an agent constant
     */
    public static boolean isAgentConst(Function func) {
<span class="fc" id="L402">    	return</span>
<span class="fc bfc" id="L403" title="All 2 branches covered.">		isConst(func) &amp;&amp;</span>
<span class="pc bpc" id="L404" title="1 of 2 branches missed.">		(func.getCodomain().getName().equals(&quot;Agent&quot;) ||</span>
<span class="fc bfc" id="L405" title="All 2 branches covered.">		(func.getCodomain() instanceof ConcreteDomain &amp;&amp;</span>
<span class="pc bpc" id="L406" title="1 of 2 branches missed.">		((ConcreteDomain) func.getCodomain()).getTypeDomain().getName().equals(&quot;Agent&quot;)));</span>
    }
    
    /**
     * A function belongs to the standard library if and only if it is static
     * and is not defined in the current model.&lt;br&gt;
     * NOTE: there is a problem if the user has forget the definition and the
     * function is not standard.
     * 
     * @param func a function
     * @return True if it belongs to the standard library
     */    
    public static boolean isBuiltIn(Function func) {
<span class="fc" id="L419">    	return </span>
<span class="pc bpc" id="L420" title="1 of 2 branches missed.">    		isStatic(func) &amp;&amp;</span>
<span class="pc bpc" id="L421" title="1 of 2 branches missed.">    		func.getDefinition() == null;</span>
    }
    
    /**
     * A function is user defined if and only if it is constant and 
     * is not defined in the standard library.&lt;br&gt;
     * NOTE: this method should be called after the discovery that the function
     * does not belong to the standard library.
     * 
     * @param func a function
     * @return True if it is user defined
     */
    public static boolean isUserDefined(Function func) {
<span class="fc" id="L434">    	return </span>
<span class="pc bpc" id="L435" title="1 of 2 branches missed.">    		isStatic(func) &amp;&amp;</span>
<span class="fc bfc" id="L436" title="All 2 branches covered.">    		func.getDefinition() != null;</span>
    }
    
    /**
	 * Checks if domain is an abstract domain.
	 * 
	 * @param domain a domain
	 * 
	 * @return true if domain is an abstract domain, false otherwise
	 */
	public static boolean isAbstractDomain(Domain domain) {
<span class="fc" id="L447">		return domain instanceof AbstractTd;</span>
	}

	/**
	 * Checks if domain is a concrete domain.
	 * 
	 * @param domain a domain
	 * 
	 * @return true if domain is a concrete domain, false otherwise
	 */
	public static boolean isConcreteDomain(Domain domain) {
<span class="fc" id="L458">		return domain instanceof ConcreteDomain;</span>
	}

	/**
	 * Checks if domain is an enum domain.
	 * 
	 * @param domain
	 *            the domain
	 * 
	 * @return true, if domain is an enum domain, false otherwise
	 */
	public static boolean isEnumDomain(Domain domain) {
<span class="fc" id="L470">		return domain instanceof EnumTd;</span>
	}

	/**
	 * Checks if domain is a boolean domain.
	 * 
	 * @param domain a domain
	 * 
	 * @return true if domain is a boolean domain, false otherwise
	 */
	public static boolean isBooleanDomain(Domain domain) {
<span class="fc" id="L481">		return domain instanceof BooleanDomain;</span>
	}

	public static boolean isStringDomain(Domain domain) {
<span class="nc" id="L485">		return domain instanceof StringDomain;</span>
	}
	
	/**
	 * Checks if rule is a block rule.
	 * 
	 * @param rule a rule
	 * 
	 * @return true if rule is a block rule, false otherwise
	 */
	public static boolean isBlockRule(Rule rule) {
<span class="fc" id="L496">		return rule instanceof BlockRule;</span>
	}

	/**
	 * Checks if rule is a seq rule.
	 * 
	 * @param rule a rule
	 * 
	 * @return true if rule is a seq rule, false otherwise
	 */
	public static boolean isSeqRule(Rule rule) {
<span class="nc" id="L507">		return rule instanceof SeqRule;</span>
	}

	/**
	 * Checks if rule is a MacroCall rule.
	 * 
	 * @param rule a rule
	 * 
	 * @return true if rule is a seq rule, false otherwise
	 */
	public static boolean isMacroCallRule(Rule rule) {
<span class="nc" id="L518">		return rule instanceof MacroCallRule;</span>
	}

	public static Function searchFunction(Asm asm, String name) {
<span class="fc" id="L522">		Collection&lt;?&gt; funcs = asm.getHeaderSection().getSignature().getFunction();</span>
<span class="pc bpc" id="L523" title="1 of 2 branches missed.">		for (Object o : funcs) {</span>
<span class="fc" id="L524">			Function f = (Function) o;</span>
<span class="fc bfc" id="L525" title="All 2 branches covered.">			if (f.getName().equals(name)) {</span>
<span class="fc" id="L526">				return f;</span>
			}
<span class="fc" id="L528">		}</span>
<span class="nc" id="L529">		throw new RuntimeException(&quot;Function &quot; + name + &quot; not found&quot;);</span>
	}
	
	public static Domain searchDomain(Asm asm, String name) {
<span class="nc" id="L533">		Collection&lt;?&gt; doms = asm.getHeaderSection().getSignature().getDomain();</span>
<span class="nc bnc" id="L534" title="All 2 branches missed.">		for (Object o : doms) {</span>
<span class="nc" id="L535">			Domain d = (Domain) o;</span>
<span class="nc bnc" id="L536" title="All 2 branches missed.">			if (d.getName().equals(name)) {</span>
<span class="nc" id="L537">				return d;</span>
			}
<span class="nc" id="L539">		}</span>
<span class="nc" id="L540">		throw new RuntimeException(&quot;Domain &quot; + name + &quot; not found&quot;);</span>
	}
	
	public static RuleDeclaration searchMacro(Asm asm, String name) {
<span class="nc" id="L544">		Collection&lt;?&gt; rules = asm.getBodySection().getRuleDeclaration();</span>
<span class="nc bnc" id="L545" title="All 2 branches missed.">		for (Object o : rules) {</span>
<span class="nc" id="L546">			RuleDeclaration r = (RuleDeclaration) o;</span>
<span class="nc bnc" id="L547" title="All 2 branches missed.">			if (r.getName().equals(name)) {</span>
<span class="nc" id="L548">				return r;</span>
			}
<span class="nc" id="L550">		}</span>
<span class="nc" id="L551">		throw new RuntimeException(&quot;Rule &quot; + name + &quot; not found&quot;);</span>
	}

	public static boolean isSelf(Function function) {
<span class="nc bnc" id="L555" title="All 6 branches missed.">		return function.getName().equals(&quot;self&quot;) &amp;&amp; function.getArity() == 0 &amp;&amp; isControlled(function);</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span></div></body></html>