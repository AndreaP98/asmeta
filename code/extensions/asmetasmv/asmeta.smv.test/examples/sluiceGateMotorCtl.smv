--file examples\sluiceGateMotorCtl.smv
-- options: flatten? false
MODULE main
	VAR
		dir: {ANTICLOCKWISE, CLOCKWISE, DIRECTIONDOMAIN_UNDEF}; --controlled
		event_bottom: boolean; --monitored
		event_top: boolean; --monitored
		motor: {MOTORDOMAIN_UNDEF, OFF, ON}; --controlled
		passed_10: boolean; --monitored
		passed_170: boolean; --monitored
		phase: {CLOSING, FULLYCLOSED, FULLYOPENED, OPENING, PHASEDOMAIN_UNDEF}; --controlled
	CONSTANTS MOTORDOMAIN_UNDEF, OFF, ON, DIRECTIONDOMAIN_UNDEF, ANTICLOCKWISE, CLOCKWISE, PHASEDOMAIN_UNDEF, CLOSING, FULLYCLOSED, FULLYOPENED, OPENING;
	ASSIGN
		init(dir) := DIRECTIONDOMAIN_UNDEF;
		init(motor) := OFF;
		init(phase) := FULLYCLOSED;
		next(dir) :=
			case
				(passed_10 & (phase = FULLYOPENED)): ANTICLOCKWISE;
				(passed_170 & (phase = FULLYCLOSED)): CLOCKWISE;
				TRUE: dir;
			esac;
		next(motor) :=
			case
				((passed_10 & (phase = FULLYOPENED)) | (passed_170 & (phase = FULLYCLOSED))): ON;
				((event_top & (phase = OPENING)) | (event_bottom & (phase = CLOSING))): OFF;
				TRUE: motor;
			esac;
		next(phase) :=
			case
				(passed_10 & (phase = FULLYOPENED)): CLOSING;
				(event_top & (phase = OPENING)): FULLYOPENED;
				(passed_170 & (phase = FULLYCLOSED)): OPENING;
				(event_bottom & (phase = CLOSING)): FULLYCLOSED;
				TRUE: phase;
			esac;
--CTL properties
CTLSPEC NAME ctl0 := AG(((phase = FULLYCLOSED) -> AX(((phase = FULLYCLOSED) | (phase = OPENING)))));
CTLSPEC NAME ctl1 := AG(((phase = OPENING) -> AX(((phase = OPENING) | (phase = FULLYOPENED)))));
CTLSPEC NAME ctl2 := AG(((phase = FULLYOPENED) -> AX(((phase = FULLYOPENED) | (phase = CLOSING)))));
CTLSPEC NAME ctl3 := AG(((phase = CLOSING) -> AX(((phase = FULLYCLOSED) | (phase = CLOSING)))));
CTLSPEC NAME ctl4 := AG(((phase = FULLYCLOSED) -> (motor = OFF)));
CTLSPEC NAME ctl5 := AG(((phase = FULLYOPENED) -> (motor = OFF)));
CTLSPEC NAME ctl6 := AG(((phase = OPENING) -> (motor = ON)));
CTLSPEC NAME ctl7 := AG(((phase = CLOSING) -> (motor = ON)));
CTLSPEC NAME ctl8 := AG(((phase = FULLYOPENED) -> EF((phase = FULLYCLOSED))));
CTLSPEC NAME ctl9 := AG(((phase = FULLYCLOSED) -> EF((phase = FULLYOPENED))));
