--file D:\GitHub\ASMETA\mvm-asmeta\newTime\UseTimer2.smv
-- options: flatten? false
@TIME_DOMAIN continuous
MODULE main
	VAR 
		timerstep: TimeLibrary(2);
		current: {LIGHT_UNDEF, OFF, ON}; --controlled
	DEFINE
		ASSIGN		
		init(current) := ON;
		next(current) :=
			case
				(timerstep.elapsed & !(current = ON) & (current = OFF)): ON;
				((current = ON) & timerstep.elapsed): OFF;
				TRUE: current;
			esac;
		next(timerstep.reset):= 
			case
				(timerstep.elapsed): TRUE;
				TRUE: FALSE;
			esac;
--LTL properties

LTLSPEC NAME ltl0 := G((current = ON));

MODULE TimeLibrary(d)
	VAR 
		currentTime: clock;
	 	start: real;
	 	reset: boolean;
	
	DEFINE elapsed := (currentTime)>=(start+d);
	ASSIGN 
	init(currentTime):=0;
	init(start):=currentTime;
	init(reset):=FALSE;
	TRANS reset -> next(start) = currentTime;
